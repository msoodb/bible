[![Build Status](https://travis-ci.org/joemccann/dillinger.svg?branch=master)](https://travis-ci.org/joemccann/dillinger)

# openssl
[openssl] is a robust, commercial-grade, full-featured toolkit for general-purpose cryptography and secure communication. 

```sh
dnf install openssl
```

```sh
openssl version
openssl version -a
openssl help
openssl ciphers -v
openssl speed
```

## How encryption works

- plain
```
October 24, 2015
MEMORANDUM FOR: Maj. G. Scott Vander Hamm, Air Force
FROM: Capt. Guion Preston, Airfield Operations
SUBJECT: Letter of recommendation for 2d Lt Kyle Suthers

Second Lieutenant Kyle Suthers has played an integral role at Keesler AFB. He has helped keep this base organized for the better part of 3 years and now aspires to become a pilot. 2d. Lt. Suthers has my full support in this endeavor.

2d. Lt. Suthers is a very capable, intelligent, and driven individual. Standing a cut above his peers, he exhibits unlimited potential. He is dedicated, focused, self-disciplined and shows remarkable leadership.

2d. Lt. Suthers consistently applies good judgement while tending to his responsibilities. Being an officer in charge of air traffic controllers, RAPCON, airfield management, and ATCALS, has provided an excellent starting point for a pilot. Although his current position does not require this, he is proficient in theory of flight, air navigation, and aircraft operating procedures.

As a skilled professional with an outstanding work ethic, 2d. Lt. Suthers will use his expertise and aptitude to become a successful pilot. I strongly suggest you take his application into close consideration. My contact details are below should any further information be required.

Capt. Guion Preston
(228) 435-6321
```

- algorithm
```
symmetric aes-256-cbc
```

- 128 bit Key
```
56C615BCE9AD5F6B2B1B30E599B32DA0CEFE21D7D618C89C10D311595A437458
```
<hr/>

- binary Coded
```
0100111101100011011101000110111101100010011001010111001000100000001100100011010000101100001000000011001000110000001100010011010100001010010011010100010101001101010011110101001001000001010011100100010001010101010011010010000001000110010011110101001000111010001000000100110101100001011010100010111000100000010001110010111000100000010100110110001101101111011101000111010000100000010101100110000101101110011001000110010101110010001000000100100001100001011011010110110100101100001000000100000101101001011100100010000001000110011011110111001001100011011001010000101001000110010100100100111101001101001110100010000001000011011000010111000001110100001011100010000001000111011101010110100101101111011011100010000001010000011100100110010101110011011101000110111101101110001011000010000001000001011010010111001001100110011010010110010101101100011001000010000001001111011100000110010101110010011000010111010001101001011011110110111001110011000010100101001101010101010000100100101001000101010000110101010000111010001000000100110001100101011101000111010001100101011100100010000001101111011001100010000001110010011001010110001101101111011011010110110101100101011011100110010001100001011101000110100101101111011011100010000001100110011011110111001000100000001100100110010000100000010011000111010000100000010010110111100101101100011001010010000001010011011101010111010001101000011001010111001001110011............
```

- 256 bit binary Key
```
0101011011000110000101011011110011101001101011010101111101101011001010110001101100110000111001011001100110110011001011011010000011001110111111100010000111010111110101100001100011001000100111000001000011010011000100010101100101011010010000110111010001011000
```

- aes algorithm block size is always 128 bits
```
Block Cipher = aes-256-cbc(128 bit binary code plain, 256 bit key)
```


- binary cipher
```
01001100011101000010111000100000010100110111010101110100011010000110010101110010011100110010000001101001011100110010000001100001001000000111011001100101011100100111100100100000011000110110000101110000011000010110001001101100011001010010110000100000011010010110111001110100011001010110110001101100011010010110011101100101011011100111010000101100001000000110000101101110011001000010000001100100011100100110100101110110011001010110111000100000011010010110111001100100011010010111011001101001011001000111010101100001011011000010111000100000010100110111010001100001011011100110010001101001011011100110011100100000011000010010000001100011011101010111010000100000011000010110001001101111011101100110010100100000011010000110100101110011001000000111000001100101011001010111001001110011001011000010000001101000011001010010000001100101011110000110100001101001011000100110100101110100011100110010000001110101011011100110110001101001011011010110100101110100011001010110010000100000011100000110111101110100011001010110111001110100011010010110000101101100001011100010000001001000011001010010000001101001011100110010000001100100011001010110010001101001011000110110000101110100011001010110010000101100001000000110011001101111011000110111010101110011011001010110010000101100001000000111001101100101011011000110011000101101011001000110100101110011011000110110100101110000011011000110100101101110011001010110010000100000011000010110111001100100001000000111001101101000011011110111011101110011001000000111001001100101011011010110000101110010011010110110000101100010011011000110010100100000011011000110010101100001011001000110010101110010011............
```

- base64 coded cipher 
```
U2FsdGVkX18rCZ3aYGJTLEPxeQ1UL27JgiSMEQxFJWBojjpEXL3k0rUtTVsWFxcp
oJc0LwT8zvj9kTICPVXInqG+DNvT5J7GAfVXVa8Vc6cY03SXedLNhGXMwsk//aLt
AystnAIY34Qq7SgdLd83v13IkRUiSgIwW75uRLAZBYuyCO8FYHDPSNHY1Nb3K8o7
OfFijJWuT9qWk1L1iVp+uR6e3Tsxg+8HTmEq6XM8eG1MleR1n3LoZ8bQJC70cJfH
giOroPPwfWKLMMJJPpUZDgp1IoKjGs7tptjm4N6K1JxzuwzNE1Hb+MltNi3+UziC
Lk7Nf23u9+3EpfJ1BTbvyQ6+lQF+7dmwwPgtWY5+H0rdzVZqgTEjoeTZNF6JKkXA
vPJAD84XNHqti+gccu07Vy0arBLUTSDG8S48u67dv4XleLT0K6x4LxJRhEEqOwYC
1dwG9nuaAWQqdMzyjdV3gX204gLzi0KfbULqKA4s3CjL/HICg5tdGFXjypgp5s8B
8Pe98RCKcy86NgsO/Xq4jB847WDrJlcNeRR/NLidYwS9+pAE6yofL1JNEFF0NiVY
e9yhJGspCqNWvgx1zvOMX5RxPj0ryHhkJXwvipg90fYsbbIaWnqXFPQ4jitg0Ji+
5kIRSdYEQ/xBQDiMNMyNo9cVoJAP+xdqL5iBk9SjgrOL/uyIxNzFku1qAZ/lbg9B
Au67F2AG/ES3L6nEKzD9meRXJGmX9e36ZDi8O8A1gxL2j2RdiHTtr1skUaP3tTr0
su0j09TgaNPJMBqWyF7e+pLvroOjMBG/ODmX3JXleY4ClwJ+7MjJbj62f......
```

- openssl command
```sh
openssl enc -e -aes-256-cbc -pbkdf2 -base64 -in plain.txt -out cipher.en -k 123
openssl enc -d -aes-256-cbc -pbkdf2 -base64 -in cipher.en -out recieve.txt -k 123
```

<hr/>

## encoding with openssl

- ASCII Table 8 bit

| character | Code |
| ------ | ------ |
| a | 01100001 |
| t | 01110100 |
| c | 01100011 |
| k | 01101011 |

attack -> 011000010111010001110100011000010110001101101011


- Base64 Table 6 bit

| character | Code |
| ------ | ------ |
| Y | 011000 |
| X | 010111 |
| R | 010001 |
| 0 | 110100 |
| W | 010110 |
| N | 001101 |
| r | 101011 |

011000010111010001110100011000010110001101101011 -> YXR0YWNr

```sh
echo -n "attack" | openssl base64
echo YXR0YWNr | openssl base64 -d
```

## hash functions

```sh
echo -n 'hello' | openssl dgst -md5
echo -n 'hello' | openssl dgst -sha1
echo -n 'hello' | openssl dgst -sha224
echo -n 'hello' | openssl dgst -sha256
echo -n 'hello' | openssl dgst -sha384
echo -n 'hello' | openssl dgst -sha3-224
echo -n 'hello' | openssl dgst -sha3-256
echo -n 'hello' | openssl dgst -sha3-384
echo -n 'hello' | openssl dgst -sha3-512
```

| input | CHF | Type | digest(Hex) |
| ----- | ------------- |----- |------ |
| hello | md5 | MD5 | 5d41402abc4b2a76b9719d911017c592 |
| hello | sha1 | SHA1 | aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d |
| hello | sha224 | SHA2 | ea09ae9cc6768c50fcee903ed054556e5bfc8347907f12598aa24193 |
| hello | sha256 | SHA2 | 2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824 |
| hello | sha384 | SHA2 | 59e1748777448c69de6b800d7a33bbfb9ff1b463e44354c3553bcdb9c666fa90125a3c79f90397bdf5f6a13de828684f |
| hello | sha512 | SHA2 | 9b71d224bd62f3785d96d46ad3ea3d73319bfbc2890caadae2dff72519673ca72323c3d99ba5c11d7c7acc6e14b8c5da0c4663475c2e5c3adef46f73bcdec043 |
| hello | sha3-224 | SHA3 | b87f88c72702fff1748e58b87e9141a42c0dbedc29a78cb0d4a5cd81 |
| hello | sha3-256 | SHA3 | 3338be694f50c5f338814986cdf0686453a888b84f424d792af4b9202398f392 |
| hello | sha3-384 | SHA3 | 720aea11019ef06440fbf05d87aa24680a2153df3907b23631e7177ce620fa1330ff07c0fddee54699a4c3ee0ee9d887 |
| hello | sha3-512 | SHA3 | 75d527c368f2efe848ecf6b073a36767800805e9eef2b1857d5f984f036eb6df891d75f72d9b154518c1cd58835286d1da9a38deba3de98b5a53e5ed78a84976 |


## Secret key for encryption

- generate random key 
```sh
openssl rand -hex 32
```
> 1e87d3ab9c5760126725edecd88a4b0b49cde4aafaf3b6b25efcc9a4500a261e

- derive a key from the password
```sh
openssl enc -aes-256-cbc -k pass123@12 -pbkdf2 -P -md sha1
```
> salt=1C3C0979C5E6DC10 \
key=23863AF7C4F5E3DCA182E32FF168237997340AC665CDA6B71312B680FC0D1981 \
iv =418A7837326126F67B3053BA09EECCB5

## aes
- generate key, and iv
```sh
openssl enc -aes-128-cbc -k 123 -pbkdf2 -P -md sha1
```
> salt=B2DC54BFAF6329C1 \
key=A8ED03E0AC0262B592EEAD7564CC234D \
iv =46D49D9426606C2119885992B59A9281

- encrypt with key and iv
```sh
echo -n hello | openssl enc -e -aes-128-cbc -base64 -nosalt -pbkdf2 -K A8ED03E0AC0262B592EEAD7564CC234D -iv 46D49D9426606C2119885992B59A9281
```
> 3p25fJMAr77tXOOn92OSiA==

- decrypt with key, and iv
```sh
echo 3p25fJMAr77tXOOn92OSiA== | openssl base64 -d | openssl enc -d -aes-128-cbc -pbkdf2 -K A8ED03E0AC0262B592EEAD7564CC234D -iv 46D49D9426606C2119885992B59A9281
```
> hello

<br/>

- encrypt with keyphrase
```sh
echo -n hello | openssl enc -e -aes-128-cbc -base64 -nosalt -pbkdf2 -k 123
```
> L31utJulbs5/CWmkUixfJA==

- decrypt with keyphrase
```sh
echo L31utJulbs5/CWmkUixfJA== | openssl base64 -d | openssl enc -d -nosalt -aes-128-cbc -pbkdf2 -k 123
```
> hello




## rsa

[//]: # (These are reference links used in the body of this note and get stripped out when the markdown processor does its job. There is no need to format nicely because it shouldn't be seen.)
   [openssl]: <https://www.openssl.org/>


